webpackJsonp([1],{"+Mvn":function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("7+uW"),o=new i.default,r=function(e,t){return e.splice(e.indexOf(t),1),e},l={name:"sidebar",data:function(){return{selection_props:{children:"children",label:"label"},selection:[],node:{nodeData:null,node:null}}},methods:{seletion_click:function(e){console.log("selection here "+e)},expandContent:function(e,t,n){o.$emit("skip-edit",0),this.node.node=t,this.node.nodeData=e;var i=this.node.node;0==i.childNodes.length&&o.$emit("content",i.parent.data.label)},showRtBtnMenu:function(e,t,n,i){this.node.nodeData=t,this.node.node=n;var r=e.clientX,l=e.clientY;o.$emit("showRtBtnMenu",[r,l])},reloadMenu:function(){var e=localStorage.getItem("title_index");if(0===e.length)return this.selection=null,0;var t=e.split("\0"),n=t.length;localStorage.setItem("counts",n);for(var i=[],o=0;o<n;o++){var r=localStorage.getItem(t[o]);i=i.concat({label:t[o],children:[{label:r}]})}this.selection=i},rename:function(){this.closeMenu();var e=this.node.node,t=null;if(t=0==e.childNodes.length?e.parent.data.label:e.data.label,null==this.node.nodeData||null==this.node.node)return alert("重命名非法！"),-1;var n=prompt("请输入新的名字");if(null==n)alert("重命名为空！");else if(n==t)alert("名字与之前的重复！");else{var i=localStorage.getItem("title_index"),o=localStorage.getItem(t);i=i.split("\0"),(i=r(i,t)).push(n),i.sort(),i=i.join("\0"),localStorage.setItem("title_index",i),localStorage.setItem(n,o),localStorage.removeItem(t),this.reloadMenu()}},deleteNode:function(){var e=this.node.node,t=null;t=0==e.childNodes.length?e.parent.data.label:e.data.label;var n=localStorage.getItem("title_index");localStorage.getItem(t);n=n.split("\0"),n=r(n,t),localStorage.removeItem(t),localStorage.setItem("title_index",n),this.reloadMenu(),this.closeMenu()},closeMenu:function(){o.$emit("rtBtnMenu","close")}},created:function(){var e=this;null==localStorage.getItem("counts")&&localStorage.setItem("counts",0);var t=localStorage.getItem("title_index");if(null!=t){var n=t.split("\0").length;localStorage.setItem("counts",n);this.reloadMenu()}o.$on("rtBtnMenu",function(t){"refresh"==t?e.reloadMenu():"rename"==t?e.rename():"delete"==t&&e.deleteNode()})},mounted:function(){}},s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-container",{staticClass:"sidebar",attrs:{id:"sideList"}},[t("el-tree",{ref:"tree",staticClass:"treebar",attrs:{data:this.selection,props:this.selection_props,"node-key":"id","highlight-current":!0},on:{"node-click":this.expandContent,"node-contextmenu":this.showRtBtnMenu}})],1)],1)},staticRenderFns:[]};var a=n("VU/8")(l,s,!1,function(e){n("+Mvn")},"data-v-89c53626",null).exports,c=n("7nRM"),u=n.n(c),d=n("d7EF"),f=n.n(d),h=n("OvRC"),m=n.n(h);function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;arguments[1];1==e?(this.name="modeError",this.stack=(new Error).stack):2==e&&(this.name="modeError",this.stack=(new Error).stack)}p.prototype=m()(Error.prototype),p.prototype.constructor=p;var v={name:"editor",data:function(){return{Buffer:{startEdited:0,endEdited:0,lastEdited:0,timerLocked:!1,firstLocked:!1,buffer1:null,buffer2:null,timer:null,timeElapse:1e4,bufferLen:0,editedLen:0},empty:"",htmlText:"内容将会在这里显示",tempText:"",edit_status:-1,skip_edit:!1,box_size:{minRows:14},mouse_focus:{focus_start:0,focus_end:0},msg:""}},methods:{testSelect:function(e){var t=window.getSelection().toString(),n=document.getElementById("editor_main"),i=n.selectionStart,o=n.selectionEnd-i,r=this.find_html(this.htmlText,t,i,o),l=f()(r,2);l[0],l[1]},checkEdited:function(e,t,n,i){var o=e.slice(0,t+1),r=e.slice(n+1,e.length),l=void 0,s=void 0;if(1==i?(l="<i>",s="</i>"):2==i?(l="<b>",s="</b>"):3==i&&(l="<u>",s="</u>"),-1!=o.lastIndexOf(l)){var a=[o.lastIndexOf(l),o.lastIndexOf(s)];a[0]>a[1]&&1}if(-1!=r.lastIndexOf(s)){var c=[r.indexOf(l),r.indexOf(s)];c[0]>c[1]&&1}},getTextSelection:function(){var e=document.getElementById("editor_main");return[e.selectionStart,e.selectionEnd,window.getSelection().toString()]},whole_wrapper:function(e,t){var n=e,i=[n.indexOf("<i>"),n.indexOf("<b>"),n.indexOf("<u>")],o=i[0],r=i[1],l=i[2],s="\0\0\0",a="\0\0\0\0";if(0===t)for(;o+r+l>-3;){var c=[(n=n.replace("<u>","").replace("</u>","").replace("<i>","").replace("</i>","").replace("<b>","").replace("</b>","")).indexOf("<i>"),n.indexOf("<b>"),n.indexOf("<u>")];o=c[0],r=c[1],l=c[2]}else if(1===t)for(;o+r+l>-3;){var u=[(n=n.replace("<u>",s).replace("</u>",a).replace("<i>",s).replace("</i>",a).replace("<b>",s).replace("</b>",a)).indexOf("<i>"),n.indexOf("<b>"),n.indexOf("<u>")];o=u[0],r=u[1],l=u[2]}return n},remove_wrapper:function(e,t,n){if(1==n){if(t.length>1)throw new p("替换字符串过长！");for(;-1!=e.indexOf(t);)e=e.replace(t,"")}return e},find_html:function(e,t,n,i){if(n>e.length)return console.log("abnormal parameters\n"),-1;if(n+i>e.length)return console.log("too long string"),-1;for(var o=this.whole_wrapper,r=this.remove_wrapper,l=0,s=0,a=o(e,1),c=n,u=0,d=t[0],f=t[i-1];;){if((u+=1)>1e4){console.log("Iteration Error, code: 1"),u=0;break}if(l=a.indexOf(d),r(a.slice(0,l+1),"\0",1).indexOf(d)==c)break;a=a.replace(d,"\f")}for(;;){if((u+=1)>1e4){console.log("Iteration Error, code: 2"),u=0;break}if(!((s=a.indexOf(f))<l))break;a=a.replace(f,"\f")}for(;;){if((u+=1)>1e4){console.log("Iteration Error, code: 3"),u=0;break}var h=a.slice(l,a.length+1);if(s=h.indexOf(f),r(h,"\0",1).indexOf(f)+1==i){s+=l;break}a=a.replace(f,"\f")}return[l,s]},changeStyle:function(e){var t=this.getTextSelection(),n=f()(t,3),i=n[0],o=n[1],r=n[2],l=(document.getElementById("editor_main"),document.getElementById("show_pad")),s=o-i,a=l.innerHTML.length,c=this.find_html(l.innerHTML,r,i,s),u=f()(c,2);i=u[0],o=u[1],o+=1;var d=l.innerHTML.slice(0,i),h=l.innerHTML.slice(o,a),m=null;if(1==e)m=r.italics();else if(2==e)m=r.bold();else{if(3!=e)throw new p(1,"要求转换字体类型错误");m="<u>"+r+"</u>"}return d+m+h},italic_operation:function(e){1==e&&(this.htmlText=this.changeStyle(1))},bold_operation:function(e){1==e&&(this.htmlText=this.changeStyle(2))},underline_operation:function(e){1==e&&(this.htmlText=this.changeStyle(3))},clearText:function(e){1===e&&(this.tempText=this.empty,this.htmlText=this.empty)},recordBuffer:function(){var e=document.getElementById("editor_main");this.Buffer;if(this.Buffer.endEdited=this.Buffer.startEdited+this.Buffer,this.Buffer.startEdited!=this.Buffer.endEdited){var t=e.value.slice(0,this.Buffer.startEdited+1),n=e.valie.slice(this.Buffer.startEdited,this.Buffer.endEdited),i=this.find_html(this.htmlText,t,0,t.length);u()(i).slice(0);0,null==this.Buffer.buffer1&&null==this.Buffer.buffer2?this.Buffer.buffer1=n:null!=this.Buffer.buffer1&&(this.Buffer.buffer2=this.Buffer.buffer1,this.Buffer.buffer1=n),this.Buffer.firstLocked=!1,this.Buffer.lastEdited=this.Buffer.startEdited,this.Buffer.editedLen=this.Buffer.bufferLen}},resetLock:function(){0==this.Buffer.timerLocked?(this.Buffer.timerLocked=!0,this.Buffer.timer=setTimeout(this.recordBuffer.bind(this),this.Buffer.timeElapse)):(clearTimeout(this.Buffer.timer),this.Buffer.timer=setTimeout(this.recordBuffer.bind(this),this.Buffer.timeElapse))},save:function(e){if(0===e.length||""==e||"请输入标题"==e)return console.log("save operation error\n"),-1;var t=this.htmlText;if(""==localStorage.getItem("title_index"))localStorage.setItem("title_index",e);else{var n=localStorage.getItem("title_index");(n=n.split("\0")).push(""+e),n.sort(),n=n.join("\0"),localStorage.setItem("title_index",n)}return localStorage.setItem(e,t),o.$emit("rtBtnMenu","refresh"),0},read_content:function(e){var t=localStorage.getItem(e);this.htmlText=t,t=this.whole_wrapper(t,0),this.tempText=t},editor_focus_func:function(){var e=this,t=document.getElementById("editor_main");document.onmousedown=function(){e.mouse_focus.focus_start=t.selectionStart},document.onmouseup=function(){e.mouse_focus.focus_end=t.selectionEnd}}},created:function(){var e=this;document.onkeyup=function(){},document.onkeydown=function(){},o.$on("aaa",function(t){e.msg=t,console.log(e.msg)}),o.$on("italic",function(t){return e.italic_operation(t)}),o.$on("bold",function(t){return e.bold_operation(t)}),o.$on("underline",function(t){return e.underline_operation(t)}),o.$on("clear",function(t){return e.clearText(t)}),o.$on("save",function(t){return e.save(t)}),o.$on("content",function(t){return e.read_content(t)}),o.$on("skip-edit",function(t){e.skip_edit=!0}),o.$on("test",function(t){return e.testSelect(t)})},watch:{tempText:function(){if(1==this.skip_edit)return this.skip_edit=!1,1;var e=0,t=document.getElementById("editor_main"),n=document.getElementById("show_pad").innerHTML.length,i=[t.selectionStart,t.selectionEnd],o=i[0],r=i[1],l=[this.mouse_focus.focus_start,this.mouse_focus.focus_end],s=l[0],a=l[1],c=0,u=0,d=a-s,h=null,m=this.htmlText;this.tempText;if(s>a){var p=[a,s];s=p[0],a=p[1]}if(0===n||"内容将会在这里显示"===m){h="";var v=["",""];return m=v[0],this.htmlText=v[1],this.htmlText=this.tempText,this.edit_status=0,0}t.value.length;var _=0;if(s==a&&(d=1,_=o-2,h=t.value.slice(o-2,o-1)),s!=a)if(s<o){var b=[o,r];this.mouse_focus.focus_start=b[0],this.mouse_focus.focus_end=b[1],s=o,a=r,h=t.value[a-2],_=o,d=1}else _=s,h=t.value.slice(s,a);var g=this.find_html(m,h,_,d),x=f()(g,2);c=x[0],u=x[1],c++,u++;var B=m.slice(0,c),S=m.slice(u,m.length),E=t.value[c];-1!=this.htmlText.indexOf("<b>")&&(e=1),1==e&&(e=0);var k=B+E+S;this.htmlText=k}},mounted:function(){this.$refs.editor_main.onfocus=this.editor_focus_func()}},_={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editor_bgc"},[n("el-input",{ref:"editor_main",staticClass:"editor_main2",attrs:{id:"editor_main",type:"textarea",placeholder:"请写下一些东西吧~",resize:"none",autosize:e.box_size},model:{value:e.tempText,callback:function(t){e.tempText=t},expression:"tempText"}}),e._v(" "),n("div",{ref:"show_pad",staticClass:"show_pad2",attrs:{id:"show_pad"},domProps:{innerHTML:e._s(e.htmlText)}})],1)},staticRenderFns:[]};var b=n("VU/8")(v,_,!1,function(e){n("YfdA")},"data-v-4027d706",null).exports,g={name:"headbox",data:function(){return{title:"请输入标题",h:"helloworld!"}},methods:{logIt:function(e){console.log("press it "+e)},save:function(){o.$emit("save",this.title)},italic:function(){o.$emit("italic",1)},bold:function(){o.$emit("bold",1)},underline:function(){o.$emit("underline",1)},clear:function(){o.$emit("clear",1)},testSelect:function(){o.$emit("test",1)},read_title:function(e){this.title=e}},created:function(){var e=this;o.$on("content",function(t){return e.read_title(t)})}},x={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"headbox"},[n("el-input",{staticClass:"title_bar",attrs:{placeholder:"标题","prefix-icon":"el-icon-document-add"},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),e._v(" "),n("el-button",{staticClass:"btn",on:{click:e.bold}},[e._v("粗体")]),e._v(" "),n("el-button",{staticClass:"btn",on:{click:e.italic}},[e._v("斜体")]),e._v(" "),n("el-button",{staticClass:"btn",on:{click:e.underline}},[e._v("下划线")]),e._v(" "),n("el-button",{staticClass:"btn",on:{click:e.clear}},[e._v("清空")]),e._v(" "),n("el-button",{staticClass:"btn",on:{click:e.save}},[e._v("保存")])],1)},staticRenderFns:[]};var B={name:"rtbutton",data:function(){return{vis:"hidden",top:"10px",left:"10px",visible:!1}},created:function(){var e=this;o.$on("showRtBtnMenu",function(t){var n=[t[0],t[1]],i=n[0],o=n[1];o=o,(i-=168)<0&&(i=-i),o<0&&(o=-o),e.visible=!0,e.x=i+"px",e.y=o+"px"}),o.$on("rtBtnMenu",function(t){"close"==t&&e.rtbtnSelection("close")})},mounted:function(){},methods:{rtbtnSelection:function(e){"close"==e?this.visible=!1:"rename"==e?o.$emit("rtBtnMenu","rename"):"refresh"==e?this.refresh():"delete"==e&&o.$emit("rtBtnMenu","delete")},refresh:function(){location.reload()}}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],ref:"menu",staticClass:"rtmenu_decorator",style:{left:e.x,top:e.y},attrs:{id:"menu"}},[n("ul",[n("li",{on:{click:function(t){return e.rtbtnSelection("rename")}}},[e._v("重命名")]),e._v(" "),n("li",{on:{click:function(t){return e.rtbtnSelection("delete")}}},[e._v("删除")]),e._v(" "),n("li",{on:{click:function(t){return e.rtbtnSelection("refresh")}}},[e._v("刷新")]),e._v(" "),n("li",{on:{click:function(t){return e.rtbtnSelection("close")}}},[e._v("关闭")])])])},staticRenderFns:[]};var E={name:"App",components:{sidebar:a,editor:b,headbox:n("VU/8")(g,x,!1,function(e){n("edEN")},"data-v-2269574f",null).exports,rtbutton:n("VU/8")(B,S,!1,function(e){n("Veul")},"data-v-6cdddb6b",null).exports}},k={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("el-container",[t("el-aside",{staticStyle:{width:"200px"}},[t("sidebar")],1),this._v(" "),t("el-container",[t("el-header",{staticStyle:{height:"100px"}},[t("headbox")],1),this._v(" "),t("el-main",[t("editor")],1),this._v(" "),t("el-footer",[t("rtbutton")],1)],1)],1)],1)},staticRenderFns:[]};var w=n("VU/8")(E,k,!1,function(e){n("nepj")},null,null).exports,I=n("/ocq");i.default.use(I.a);var T=new I.a({routes:[{path:"/",name:"index",component:b}]}),$=n("kciL");i.default.use($.a);var y=new $.a.Store({state:{italic:10010,bold:0},mutations:{toItalic:function(e){0==e.italic?e.italic=1:e.italic=0}}}),M=n("bQIR"),O=n.n(M);n("gFLX"),n("Z5Wq");i.default.config.productionTip=!1,i.default.use(O.a),new i.default({el:"#app",router:T,store:y,components:{App:w},template:"<App/>"})},Veul:function(e,t){},YfdA:function(e,t){},Z5Wq:function(e,t){},edEN:function(e,t){},gFLX:function(e,t){},nepj:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.bad17f2148afc86e6229.js.map